# AI智能回复功能使用指南

## 🎯 功能概述

AW98tang 现已集成 AI 智能回复功能！系统会优先使用 AI 生成更自然、更人性化的回复内容，如果 AI 服务不可用，会自动降级使用规则回复系统。

---

## ✨ 核心特性

- ✅ **多AI接口支持**: OpenAI、Claude、国产AI（智谱、DeepSeek等）
- ✅ **智能降级**: AI失败时自动使用规则回复
- ✅ **自定义提示词**: 完全掌控AI回复风格
- ✅ **Web可视化配置**: 无需编辑配置文件
- ✅ **一键测试**: 配置后立即测试连接
- ✅ **灵活控制**: 随时启用/关闭AI回复

---

## 🚀 快速开始

### 方案1: 使用 OpenAI / ChatGPT

1. **获取API Key**
   - 访问: https://platform.openai.com/api-keys
   - 创建新的API Key
   - 复制 Key（格式：`sk-...`）

2. **在Web界面配置**
   - 登录 Web 控制面板
   - 点击左侧 "⚙️ 系统配置"
   - 滚动到 "🤖 AI智能回复配置" 区域
   - 配置如下：
     ```
     启用AI回复: 是（优先使用AI）
     AI接口类型: OpenAI / 兼容接口
     AI模型: gpt-3.5-turbo
     API地址: (留空)
     API Key: sk-你的密钥
     生成温度: 0.8
     最大长度: 200
     超时时间: 10
     ```

3. **测试连接**
   - 点击 "🧪 测试AI连接" 按钮
   - 等待测试结果
   - 如果成功，会显示AI生成的测试回复

4. **保存并运行**
   - 点击 "💾 保存配置"
   - 启动机器人
   - 查看日志，会显示 "🤖 尝试使用AI生成回复..."

---

### 方案2: 使用国产AI（智谱AI为例）

1. **获取API Key**
   - 访问: https://open.bigmodel.cn/
   - 注册并创建API Key

2. **在Web界面配置**
   ```
   启用AI回复: 是
   AI接口类型: OpenAI / 兼容接口
   AI模型: glm-4
   API地址: https://open.bigmodel.cn/api/paas/v4/chat/completions
   API Key: 你的密钥
   ```

3. **测试并保存**

---

### 方案3: 使用 DeepSeek（超便宜）

1. **获取API Key**
   - 访问: https://platform.deepseek.com/
   - 注册并获取API Key

2. **配置**
   ```
   启用AI回复: 是
   AI接口类型: OpenAI / 兼容接口
   AI模型: deepseek-chat
   API地址: https://api.deepseek.com/v1/chat/completions
   API Key: sk-你的密钥
   ```

---

### 方案4: 使用 Claude

1. **获取API Key**
   - 访问: https://console.anthropic.com/
   - 创建API Key

2. **配置**
   ```
   启用AI回复: 是
   AI接口类型: Claude
   AI模型: claude-3-haiku-20240307
   API地址: (留空)
   API Key: sk-ant-你的密钥
   ```

---

## 🎨 自定义AI回复风格

### 系统提示词示例

#### 1. 友好温和风格
```
你是一个热情友好的论坛用户，需要根据帖子标题和内容生成简短的回复。
回复要自然、友好、简洁，不超过50字。
多使用感谢、支持、鼓励类词汇，保持积极正能量。
```

#### 2. 专业评论风格
```
你是一个经验丰富的论坛用户，会对帖子内容进行简短点评。
回复要客观、专业，不超过50字。
可以适当使用专业术语，但保持通俗易懂。
```

#### 3. 幽默风趣风格
```
你是一个幽默风趣的论坛用户，回复要轻松有趣。
不超过50字，可以适当使用网络流行语和表情符号。
保持轻松愉快的语气，但不要过度夸张。
```

#### 4. 简洁实用风格
```
你是一个注重实用的论坛用户，回复要简洁明了。
不超过30字，直接表达观点或感受。
避免冗余词汇，言简意赅。
```

---

## ⚙️ 配置参数详解

### 基础配置

| 参数 | 说明 | 推荐值 | 范围 |
|------|------|--------|------|
| **启用AI回复** | 是否启用AI生成回复 | 是 | 是/否 |
| **AI接口类型** | AI服务提供商 | openai | openai/claude/custom |
| **AI模型** | 使用的模型名称 | gpt-3.5-turbo | 取决于服务商 |
| **API地址** | 接口URL（可选） | (留空) | 完整URL |
| **API Key** | 认证密钥（必填） | - | 由服务商提供 |

### 高级参数

| 参数 | 说明 | 推荐值 | 范围 |
|------|------|--------|------|
| **生成温度** | 控制随机性，越大越随机 | 0.8 | 0-1 |
| **最大长度** | 最大生成token数 | 200 | 50-500 |
| **超时时间** | 请求超时秒数 | 10 | 5-60 |

---

## 🌐 支持的AI服务

### 国际服务

| 服务 | API类型 | 默认地址 | 推荐模型 | 备注 |
|------|---------|----------|----------|------|
| **OpenAI** | openai | api.openai.com | gpt-3.5-turbo | 最常用 |
| **Claude** | claude | api.anthropic.com | claude-3-haiku | 价格实惠 |

### 国产AI

| 服务 | API类型 | API地址 | 推荐模型 | 获取地址 |
|------|---------|---------|----------|----------|
| **智谱AI** | openai | open.bigmodel.cn/api/paas/v4/chat/completions | glm-4 | open.bigmodel.cn |
| **DeepSeek** | openai | api.deepseek.com/v1/chat/completions | deepseek-chat | platform.deepseek.com |
| **月之暗面** | openai | api.moonshot.cn/v1/chat/completions | moonshot-v1-8k | kimi.moonshot.cn |
| **通义千问** | custom | dashscope.aliyuncs.com/... | qwen-turbo | dashscope.aliyun.com |
| **文心一言** | custom | aip.baidubce.com/... | ernie-bot | cloud.baidu.com |

---

## 🔧 故障排查

### 问题1: 测试连接失败

**可能原因:**
- API Key 错误或过期
- API地址配置错误
- 网络连接问题
- 模型名称错误

**解决方案:**
1. 检查API Key是否正确复制
2. 确认API地址格式正确
3. 尝试在浏览器访问API服务商网站
4. 查看服务商文档确认模型名称

---

### 问题2: AI回复失败，使用了规则回复

**可能原因:**
- API请求超时
- API额度用完
- 服务商限流

**解决方案:**
1. 增加超时时间（如改为30秒）
2. 检查API账户余额
3. 等待一段时间后重试
4. 系统会自动降级，不影响正常使用

---

### 问题3: 回复内容不符合预期

**解决方案:**
1. 修改系统提示词，更明确地描述期望风格
2. 调整生成温度（降低温度会更保守）
3. 修改最大长度限制

---

## 💡 最佳实践

### 1. 成本优化

- **使用国产AI**: DeepSeek、智谱等比OpenAI便宜很多
- **控制长度**: 设置合理的最大长度（200已足够）
- **降级策略**: 启用AI但准备好规则回复作为备份

### 2. 回复质量

- **优化提示词**: 明确告知AI你的需求和风格
- **测试调整**: 多测试几次，找到最佳参数
- **温度设置**: 0.7-0.9 的温度通常效果最好

### 3. 稳定性

- **设置超时**: 避免单个请求等待太久
- **启用降级**: 确保AI失败时系统仍能工作
- **监控日志**: 定期查看日志了解AI使用情况

---

## 📊 成本对比

### 按1000次回复计算

| 服务 | 模型 | 预估成本 | 速度 | 推荐度 |
|------|------|----------|------|--------|
| OpenAI | gpt-3.5-turbo | ¥7-14 | 快 | ⭐⭐⭐ |
| OpenAI | gpt-4 | ¥140-280 | 中 | ⭐⭐ |
| DeepSeek | deepseek-chat | ¥0.7-1.4 | 快 | ⭐⭐⭐⭐⭐ |
| 智谱AI | glm-4 | ¥3-6 | 快 | ⭐⭐⭐⭐ |
| Claude | claude-3-haiku | ¥1.5-3 | 快 | ⭐⭐⭐⭐ |

**推荐**: DeepSeek（性价比最高）或 智谱AI（国产稳定）

---

## 🎁 配置示例

### 完整配置（config.json）

```json
{
  "enable_ai_reply": true,
  "ai_api_type": "openai",
  "ai_api_url": "https://api.deepseek.com/v1/chat/completions",
  "ai_api_key": "sk-your-api-key-here",
  "ai_model": "deepseek-chat",
  "ai_temperature": 0.8,
  "ai_max_tokens": 200,
  "ai_timeout": 10,
  "ai_system_prompt": "你是一个热情友好的论坛用户，需要根据帖子标题和内容生成简短的回复。回复要自然、友好、简洁，不超过50字。不要使用敏感词汇，保持礼貌和正能量。"
}
```

---

## ❓ 常见问题

### Q: AI回复和规则回复有什么区别？

**A**: 
- **AI回复**: 根据帖子实际内容生成，更自然、更相关
- **规则回复**: 基于关键词匹配模板，相对固定

### Q: AI回复会被识别为机器人吗？

**A**: AI生成的内容更像真人，配合适当的提示词，很难被识别。

### Q: 可以同时使用多个AI服务吗？

**A**: 目前只支持配置一个AI服务，如果失败会降级到规则回复。

### Q: 如何降低AI使用成本？

**A**: 
1. 使用DeepSeek等低成本服务
2. 减少max_tokens设置
3. 在低峰时段运行

---

## 🔄 更新记录

- **v3.4** (2025-10): 首次集成AI智能回复功能
  - 支持OpenAI、Claude、国产AI
  - Web可视化配置
  - 一键测试功能
  - 智能降级机制

---

## 📞 技术支持

如有问题，请：
1. 查看日志文件 `logs/selenium_bot.log`
2. 检查配置文件格式
3. 测试AI接口连接
4. 查看服务商文档

---

**祝你使用愉快！🎉**

