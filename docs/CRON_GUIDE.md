# Cron è¡¨è¾¾å¼è°ƒåº¦æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

v3.7 ç‰ˆæœ¬æ–°å¢äº† **Cron è¡¨è¾¾å¼è°ƒåº¦**åŠŸèƒ½ï¼Œè®©å®šæ—¶ä»»åŠ¡é…ç½®æ›´åŠ çµæ´»å¼ºå¤§ã€‚

## âœ¨ æ–°åŠŸèƒ½

### 1. æ”¯æŒæ ‡å‡† Cron è¡¨è¾¾å¼

ä½¿ç”¨æ ‡å‡†çš„ 5 å­—æ®µ Cron è¡¨è¾¾å¼ï¼š

```
åˆ†é’Ÿ å°æ—¶ æ—¥ æœˆ æ˜ŸæœŸ
 *   *   *  *  *
```

### 2. ä¸‰ç§è°ƒåº¦æ¨¡å¼

| æ¨¡å¼ | é…ç½®å‚æ•° | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|---------|--------|------|
| **Cron è¡¨è¾¾å¼** | `schedule_cron` | â­â­â­ æœ€é«˜ | æœ€çµæ´»ï¼Œæ”¯æŒå¤æ‚è°ƒåº¦ |
| **å›ºå®šæ—¶é—´ç‚¹** | `schedule_times` | â­â­ ä¸­ | ç®€å•æ˜“ç”¨ï¼Œé€‚åˆå›ºå®šæ—¶é—´ |
| **å•ä¸€æ—¶é—´** | `schedule_time` | â­ ä½ | å…¼å®¹æ—§ç‰ˆï¼Œä»…å•ä¸ªæ—¶é—´ |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ 1: ä½¿ç”¨ Cron è¡¨è¾¾å¼ï¼ˆæ¨èï¼‰

ç¼–è¾‘ `config.json`ï¼š

```json
{
  "enable_scheduler": true,
  "schedule_cron": "0 3,9,15,21 * * *"
}
```

è¿™è¡¨ç¤ºï¼šæ¯å¤©çš„ 3ç‚¹ã€9ç‚¹ã€15ç‚¹ã€21ç‚¹ è¿è¡Œ

### æ–¹å¼ 2: ä½¿ç”¨å›ºå®šæ—¶é—´ç‚¹

```json
{
  "enable_scheduler": true,
  "schedule_times": ["03:00", "09:00", "15:00", "21:00"]
}
```

### æ–¹å¼ 3: ä½¿ç”¨å•ä¸€æ—¶é—´ï¼ˆæ—§ç‰ˆå…¼å®¹ï¼‰

```json
{
  "enable_scheduler": true,
  "schedule_time": "03:00"
}
```

## ğŸ“š Cron è¡¨è¾¾å¼è¯­æ³•

### åŸºæœ¬æ ¼å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ åˆ†é’Ÿ (0 - 59)
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å°æ—¶ (0 - 23)
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ—¥ (1 - 31)
â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æœˆ (1 - 12)
â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ˜ŸæœŸ (0 - 6) (0=å‘¨æ—¥)
â”‚ â”‚ â”‚ â”‚ â”‚
* * * * *
```

### ç‰¹æ®Šå­—ç¬¦

| å­—ç¬¦ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `*` | ä»»ä½•å€¼ | `* * * * *` = æ¯åˆ†é’Ÿ |
| `,` | åˆ—ä¸¾å¤šä¸ªå€¼ | `0 3,9,15,21 * * *` = æ¯å¤©3,9,15,21ç‚¹ |
| `-` | èŒƒå›´ | `0 9-17 * * *` = æ¯å¤©9-17ç‚¹ |
| `/` | é—´éš” | `*/30 * * * *` = æ¯30åˆ†é’Ÿ |

## ğŸ’¡ å¸¸ç”¨ç¤ºä¾‹

### æ¯å¤©å›ºå®šæ—¶é—´

```json
{
  "schedule_cron": "0 3 * * *",
  "è¯´æ˜": "æ¯å¤©å‡Œæ™¨3ç‚¹"
}
```

```json
{
  "schedule_cron": "0 3,9,15,21 * * *",
  "è¯´æ˜": "æ¯å¤©3ç‚¹ã€9ç‚¹ã€15ç‚¹ã€21ç‚¹"
}
```

### æ¯éš”Nå°æ—¶

```json
{
  "schedule_cron": "0 */6 * * *",
  "è¯´æ˜": "æ¯6å°æ—¶ï¼ˆ0ç‚¹ã€6ç‚¹ã€12ç‚¹ã€18ç‚¹ï¼‰"
}
```

```json
{
  "schedule_cron": "0 */4 * * *",
  "è¯´æ˜": "æ¯4å°æ—¶"
}
```

### æ¯éš”Nåˆ†é’Ÿ

```json
{
  "schedule_cron": "*/30 * * * *",
  "è¯´æ˜": "æ¯30åˆ†é’Ÿ"
}
```

```json
{
  "schedule_cron": "0,30 * * * *",
  "è¯´æ˜": "æ¯å°æ—¶çš„0åˆ†å’Œ30åˆ†"
}
```

### å·¥ä½œæ—¥/å‘¨æœ«

```json
{
  "schedule_cron": "0 9 * * 1-5",
  "è¯´æ˜": "å·¥ä½œæ—¥ï¼ˆå‘¨ä¸€åˆ°å‘¨äº”ï¼‰æ—©ä¸Š9ç‚¹"
}
```

```json
{
  "schedule_cron": "0 10 * * 0,6",
  "è¯´æ˜": "å‘¨æœ«ï¼ˆå‘¨å…­ã€å‘¨æ—¥ï¼‰æ—©ä¸Š10ç‚¹"
}
```

### ç‰¹å®šæ—¥æœŸ

```json
{
  "schedule_cron": "0 3 1 * *",
  "è¯´æ˜": "æ¯æœˆ1å·å‡Œæ™¨3ç‚¹"
}
```

```json
{
  "schedule_cron": "0 3 1,15 * *",
  "è¯´æ˜": "æ¯æœˆ1å·å’Œ15å·å‡Œæ™¨3ç‚¹"
}
```

## ğŸ¯ æ¨èé…ç½®

### é«˜æˆåŠŸç‡é…ç½®ï¼ˆæ¨èï¼‰

```json
{
  "enable_scheduler": true,
  "schedule_cron": "0 3,9,15,21 * * *"
}
```

**è¯´æ˜**ï¼šæ¯å¤©4ä¸ªæ—¶é—´ç‚¹ï¼Œé…åˆè‡ªåŠ¨é‡è¯•ï¼ŒæˆåŠŸç‡ >99%

### ä½é¢‘ç‡é…ç½®

```json
{
  "enable_scheduler": true,
  "schedule_cron": "0 3 * * *"
}
```

**è¯´æ˜**ï¼šæ¯å¤©åªè¿è¡Œä¸€æ¬¡ï¼Œé€‚åˆç½‘ç»œç¨³å®šç¯å¢ƒ

### é«˜é¢‘ç‡é…ç½®

```json
{
  "enable_scheduler": true,
  "schedule_cron": "0 */2 * * *"
}
```

**è¯´æ˜**ï¼šæ¯2å°æ—¶è¿è¡Œä¸€æ¬¡ï¼Œé€‚åˆç½‘ç»œä¸ç¨³å®šç¯å¢ƒ

### å·¥ä½œæ—¶é—´é…ç½®

```json
{
  "enable_scheduler": true,
  "schedule_cron": "0 9,12,15,18 * * 1-5"
}
```

**è¯´æ˜**ï¼šå·¥ä½œæ—¥çš„9ç‚¹ã€12ç‚¹ã€15ç‚¹ã€18ç‚¹è¿è¡Œ

## ğŸ” éªŒè¯ Cron è¡¨è¾¾å¼

### æ–¹æ³• 1: åœ¨çº¿éªŒè¯

è®¿é—®ï¼šhttps://crontab.guru/

è¾“å…¥ä½ çš„ cron è¡¨è¾¾å¼ï¼ŒæŸ¥çœ‹æ‰§è¡Œæ—¶é—´

### æ–¹æ³• 2: Python éªŒè¯

```bash
python -c "from croniter import croniter; from datetime import datetime; cron = croniter('ä½ çš„cronè¡¨è¾¾å¼', datetime.now()); print('ä¸‹æ¬¡è¿è¡Œ:', cron.get_next(datetime))"
```

### æ–¹æ³• 3: å¯åŠ¨è°ƒåº¦å™¨æŸ¥çœ‹

```bash
python scheduler.py
```

å¯åŠ¨åä¼šæ˜¾ç¤ºï¼š
```
ğŸ“… è°ƒåº¦æ¨¡å¼: Cronè¡¨è¾¾å¼
â° Cron: 0 3,9,15,21 * * *
â° ä¸‹æ¬¡è¿è¡Œ: 2025-10-27 15:00:00
```

## âš™ï¸ é…ç½®ä¼˜å…ˆçº§

ç³»ç»ŸæŒ‰ä»¥ä¸‹é¡ºåºæ£€æŸ¥é…ç½®ï¼š

1. **`schedule_cron`** - å¦‚æœå­˜åœ¨ä¸”æœ‰æ•ˆï¼Œä½¿ç”¨ Cron æ¨¡å¼
2. **`schedule_times`** - å¦‚æœ cron ä¸ºç©ºï¼Œä½¿ç”¨æ—¶é—´ç‚¹æ¨¡å¼
3. **`schedule_time`** - å¦‚æœä»¥ä¸Šéƒ½æ²¡æœ‰ï¼Œä½¿ç”¨å•æ—¶é—´æ¨¡å¼
4. **é»˜è®¤å€¼** - ä½¿ç”¨ `['03:00', '09:00', '15:00', '21:00']`

## ğŸ› æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: Cron è¡¨è¾¾å¼æ— æ•ˆ

**é”™è¯¯ä¿¡æ¯**ï¼š
```
âŒ Cronè¡¨è¾¾å¼æ— æ•ˆ: 0 3 * *
å°†ä½¿ç”¨æ—¶é—´ç‚¹æ¨¡å¼...
```

**åŸå› **ï¼šCron è¡¨è¾¾å¼å¿…é¡»æ˜¯ 5 ä¸ªå­—æ®µ

**è§£å†³**ï¼š
```json
{
  "schedule_cron": "0 3 * * *"
}
```

### é—®é¢˜ 2: æ¨¡å—æœªå®‰è£…

**é”™è¯¯ä¿¡æ¯**ï¼š
```
ModuleNotFoundError: No module named 'croniter'
```

**è§£å†³**ï¼š
```bash
pip install croniter
# æˆ–
pip install -r requirements.txt
```

### é—®é¢˜ 3: æ—¶é—´ä¸å‡†ç¡®

**æ£€æŸ¥äº‹é¡¹**ï¼š
- ç³»ç»Ÿæ—¶åŒºæ˜¯å¦æ­£ç¡®
- Docker å®¹å™¨æ—¶åŒºè®¾ç½®
- Cron è¡¨è¾¾å¼æ˜¯å¦æ­£ç¡®

**Docker æ—¶åŒºè®¾ç½®**ï¼š
```yaml
# docker-compose.yml
environment:
  - TZ=Asia/Shanghai
```

## ğŸ“Š æ€§èƒ½å»ºè®®

### 1. åˆç†è®¾ç½®é¢‘ç‡

| é¢‘ç‡ | Cron è¡¨è¾¾å¼ | CPUå ç”¨ | é€‚ç”¨åœºæ™¯ |
|------|------------|---------|---------|
| æ¯å¤©1æ¬¡ | `0 3 * * *` | æä½ | ç½‘ç»œç¨³å®š |
| æ¯å¤©4æ¬¡ | `0 3,9,15,21 * * *` | ä½ | **æ¨è** |
| æ¯6å°æ—¶ | `0 */6 * * *` | ä¸­ | é«˜å¯é æ€§è¦æ±‚ |
| æ¯å°æ—¶ | `0 * * * *` | é«˜ | ä¸æ¨è |

### 2. é¿å…é«˜å³°æœŸ

å»ºè®®é¿å¼€ï¼š
- 0ç‚¹ï¼ˆæ•°æ®åº“å¤‡ä»½ï¼‰
- 12ç‚¹ï¼ˆåˆä¼‘é«˜å³°ï¼‰
- 18ç‚¹ï¼ˆä¸‹ç­é«˜å³°ï¼‰

æ¨èæ—¶æ®µï¼š
- å‡Œæ™¨ 3ç‚¹ï¼ˆæœ€ç¨³å®šï¼‰
- ä¸Šåˆ 9ç‚¹
- ä¸‹åˆ 3ç‚¹
- æ™šä¸Š 21ç‚¹

### 3. é…åˆæ™ºèƒ½è·³è¿‡

ç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹ç­¾åˆ°çŠ¶æ€ï¼Œå·²ç­¾åˆ°ä¼šè·³è¿‡åç»­è¿è¡Œï¼Œæ— éœ€æ‹…å¿ƒè¿è¡Œæ¬¡æ•°è¿‡å¤šã€‚

## ğŸ“ é«˜çº§ç”¨æ³•

### 1. å¤åˆæ¡ä»¶

```json
{
  "schedule_cron": "0 3,9,15,21 * * 1-5",
  "è¯´æ˜": "å·¥ä½œæ—¥çš„3,9,15,21ç‚¹"
}
```

### 2. ç‰¹å®šæœˆä»½

```json
{
  "schedule_cron": "0 3 * 1,7 *",
  "è¯´æ˜": "æ¯å¹´1æœˆå’Œ7æœˆçš„æ¯å¤©3ç‚¹"
}
```

### 3. ç»„åˆé—´éš”

```json
{
  "schedule_cron": "0 */2 * * *",
  "è¯´æ˜": "æ¯2å°æ—¶"
}
```

```json
{
  "schedule_cron": "*/15 * * * *",
  "è¯´æ˜": "æ¯15åˆ†é’Ÿ"
}
```

## ğŸ“ é…ç½®æ¨¡æ¿

### æ¨¡æ¿ 1: æ ‡å‡†é…ç½®

```json
{
  "enable_scheduler": true,
  "schedule_cron": "0 3,9,15,21 * * *",
  "max_replies_per_day": 30,
  "enable_daily_checkin": true,
  "enable_auto_reply": true
}
```

### æ¨¡æ¿ 2: ä½é¢‘é…ç½®

```json
{
  "enable_scheduler": true,
  "schedule_cron": "0 3 * * *",
  "max_replies_per_day": 10,
  "enable_daily_checkin": true,
  "enable_auto_reply": true
}
```

### æ¨¡æ¿ 3: é«˜é¢‘é…ç½®

```json
{
  "enable_scheduler": true,
  "schedule_cron": "0 */3 * * *",
  "max_replies_per_day": 50,
  "enable_daily_checkin": true,
  "enable_auto_reply": true
}
```

## ğŸ”„ è¿ç§»æŒ‡å—

### ä»å›ºå®šæ—¶é—´ç‚¹è¿ç§»åˆ° Cron

**æ—§é…ç½®**ï¼š
```json
{
  "schedule_times": ["03:00", "09:00", "15:00", "21:00"]
}
```

**æ–°é…ç½®**ï¼š
```json
{
  "schedule_cron": "0 3,9,15,21 * * *"
}
```

### ä»å•ä¸€æ—¶é—´è¿ç§»åˆ° Cron

**æ—§é…ç½®**ï¼š
```json
{
  "schedule_time": "03:00"
}
```

**æ–°é…ç½®**ï¼š
```json
{
  "schedule_cron": "0 3 * * *"
}
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### å‚è€ƒèµ„æ–™

- [Crontab Guru](https://crontab.guru/) - åœ¨çº¿ Cron è¡¨è¾¾å¼éªŒè¯
- [Croniter æ–‡æ¡£](https://github.com/kiorky/croniter) - Python Cron åº“
- [Wikipedia: Cron](https://en.wikipedia.org/wiki/Cron) - Cron è¯¦ç»†è¯´æ˜

### é—®é¢˜åé¦ˆ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. é…ç½®æ–‡ä»¶ï¼ˆéšè—æ•æ„Ÿä¿¡æ¯ï¼‰
2. é”™è¯¯æ—¥å¿—
3. Cron è¡¨è¾¾å¼

---

**æœ€åæ›´æ–°**: 2025-10-27  
**ç‰ˆæœ¬**: v3.7.0  
**åŠŸèƒ½**: Cron è¡¨è¾¾å¼è°ƒåº¦

